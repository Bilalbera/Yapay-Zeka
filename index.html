<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>BilalAI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#0f172a;
  --panel:#111827;
  --border:#1f2937;
  --text:#e5e7eb;
  --accent:#3b82f6;
  --code:#020617;
}
*{box-sizing:border-box;font-family:system-ui}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  height:100vh;
  display:flex;
}
aside{
  width:260px;
  background:var(--panel);
  border-right:1px solid var(--border);
  padding:16px;
}
aside h1{margin:0 0 16px;font-size:20px}
aside button{
  width:100%;
  padding:10px;
  margin-bottom:8px;
  background:none;
  border:1px solid var(--border);
  color:var(--text);
  cursor:pointer;
}
aside button.active{background:var(--accent)}
main{flex:1;display:flex;flex-direction:column}
#chat{flex:1;padding:20px;overflow-y:auto}
.msg{max-width:900px;margin-bottom:14px}
.user{color:#60a5fa}
.ai{color:#a7f3d0}
.code{
  background:var(--code);
  border:1px solid var(--border);
  padding:12px;
  border-radius:6px;
  position:relative;
  white-space:pre;
  overflow-x:auto;
  margin-top:6px;
}
.copy{
  position:absolute;
  top:6px;
  right:6px;
  background:var(--accent);
  border:none;
  color:#fff;
  font-size:12px;
  padding:4px 8px;
  cursor:pointer;
}
#input{
  display:flex;
  padding:16px;
  border-top:1px solid var(--border);
}
#input input{
  flex:1;
  padding:12px;
  background:#020617;
  border:1px solid var(--border);
  color:var(--text);
}
#input button{
  padding:12px 20px;
  background:var(--accent);
  border:none;
  color:#fff;
  cursor:pointer;
}
canvas{margin-top:8px;border:1px solid var(--border)}
</style>
</head>

<body>

<aside>
  <h1>BilalAI</h1>
  <button class="active" data-mode="chat">ðŸ’¬ Sohbet</button>
  <button data-mode="code">ðŸ’» Kod</button>
  <button data-mode="image">ðŸ–¼ GÃ¶rsel</button>
</aside>

<main>
  <div id="chat"></div>
  <div id="input">
    <input id="prompt" placeholder="BilalAI'ye yaz..." />
    <button id="send">GÃ¶nder</button>
  </div>
</main>

<script>
const chat = document.getElementById("chat");
const input = document.getElementById("prompt");
let mode = "chat";

/* ---------- LOCAL STORAGE ---------- */
const STORAGE_KEY = "bilalai_chat";

function saveChat() {
  localStorage.setItem(STORAGE_KEY, chat.innerHTML);
}
function loadChat() {
  const saved = localStorage.getItem(STORAGE_KEY);
  if (saved) chat.innerHTML = saved;
}
loadChat();

/* ---------- MODE ---------- */
document.querySelectorAll("aside button").forEach(btn=>{
  btn.onclick = () => {
    document.querySelectorAll("aside button").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    mode = btn.dataset.mode;
    addAI("Mod deÄŸiÅŸtirildi: " + mode.toUpperCase());
  };
});

/* ---------- MESSAGE HELPERS ---------- */
function addUser(text){
  const d=document.createElement("div");
  d.className="msg user";
  d.textContent="Sen: "+text;
  chat.appendChild(d);
  saveChat(); scroll();
}
function addAI(text){
  const d=document.createElement("div");
  d.className="msg ai";
  d.textContent="BilalAI: "+text;
  chat.appendChild(d);
  saveChat(); scroll();
}
function addCode(code){
  const d=document.createElement("div");
  d.className="msg ai";
  d.innerHTML=`BilalAI:
  <div class="code">
    <button class="copy">Kopyala</button>${code}
  </div>`;
  d.querySelector(".copy").onclick=()=>navigator.clipboard.writeText(code);
  chat.appendChild(d);
  saveChat(); scroll();
}
function addImage(text){
  const c=document.createElement("canvas");
  c.width=512;c.height=512;
  const x=c.getContext("2d");
  x.fillStyle="#020617";x.fillRect(0,0,512,512);
  x.fillStyle="#3b82f6";x.font="20px sans-serif";
  x.fillText("BilalAI GÃ¶rsel",20,40);
  x.fillStyle="#e5e7eb";wrap(x,text,20,80,470,26);

  const d=document.createElement("div");
  d.className="msg ai";
  d.textContent="BilalAI:";
  d.appendChild(c);
  chat.appendChild(d);
  saveChat(); scroll();
}
function wrap(ctx,t,x,y,w,h){
  let words=t.split(" "),line="";
  words.forEach(word=>{
    let test=line+word+" ";
    if(ctx.measureText(test).width>w){
      ctx.fillText(line,x,y);line=word+" ";y+=h;
    } else line=test;
  });
  ctx.fillText(line,x,y);
}
function scroll(){chat.scrollTop=chat.scrollHeight}

/* ---------- SEND ---------- */
document.getElementById("send").onclick = send;
input.addEventListener("keydown",e=>e.key==="Enter"&&send());

function send(){
  const text=input.value.trim();
  if(!text) return;
  addUser(text);
  input.value="";
  setTimeout(()=>{
    if(mode==="chat") addAI("Sorunu anladÄ±m. BilalAI tutarlÄ± ve hatasÄ±z cevap Ã¼retir.");
    if(mode==="code") addCode(`<!DOCTYPE html>
<html>
<body>
<h1>BilalAI Kod</h1>
</body>
</html>`);
    if(mode==="image") addImage(text);
  },300);
}
</script>

</body>
</html>
