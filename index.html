<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BilalAI: GeliÅŸmiÅŸ Sohbet ve Kodlama AsistanÄ±</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; background-color: #e9eef2; margin: 0; }
        .chat-container { width: 95%; max-width: 800px; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
        h2 { color: #333; border-bottom: 2px solid #007bff; padding-bottom: 10px; margin-top: 0; }
        
        /* Ã‡Ä±ktÄ± AlanÄ± Stili */
        #output { border: 1px solid #ddd; padding: 15px; min-height: 200px; margin-bottom: 20px; border-radius: 8px; background-color: #f7f9fb; overflow-y: auto; max-height: 60vh; }
        
        /* Kod BloÄŸu Stili - Belirginlik ve Kopyalanabilirlik */
        pre { 
            background-color: #272822; 
            color: #f8f8f2; 
            padding: 15px; 
            border-radius: 6px; 
            overflow-x: auto; 
            font-family: 'Consolas', 'Courier New', monospace; 
            font-size: 0.9em; 
            position: relative; 
            /* Kod Ã¼stÃ¼ne kopyalama butonu eklemek isterseniz bu alandan devam edebilirsiniz */
        }
        code { background-color: transparent; color: inherit; padding: 0; }

        /* KullanÄ±cÄ± GiriÅŸ AlanÄ± */
        .input-area { display: flex; gap: 10px; }
        #userInput { flex-grow: 1; padding: 12px; border: 1px solid #ced4da; border-radius: 6px; box-sizing: border-box; font-size: 1em; }
        #sendButton { padding: 12px 25px; background-color: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1em; transition: background-color 0.3s; }
        #sendButton:hover { background-color: #0056b3; }
        #sendButton:disabled { background-color: #adb5bd; cursor: not-allowed; }

        /* YÃ¼kleme Simgesi */
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #007bff; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: none; margin-left: 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="chat-container">
    <h2>ğŸš€ BilalAI - Kod AsistanÄ±nÄ±z</h2>
    <div id="output"><strong>HoÅŸ geldiniz!</strong> Ben BilalAI. LÃ¼tfen bir soru sorun, isterseniz direkt kod isteyin.</div>
    <div class="input-area">
        <input type="text" id="userInput" placeholder="Yapay zekaya bir ÅŸey sorun (Ã–rn: Python'da 'Hello World' kodu ver)...">
        <button id="sendButton">GÃ¶nder</button>
        <div id="loader" class="loader"></div>
    </div>
</div>

<script>
    // *******************************************************************
    // !!! API AnahtarÄ±nÄ±z buraya yerleÅŸtirildi !!! 
    // *******************************************************************
    const API_KEY = "AIzaSyAtTbCNCtOQJDCnYUb9wKFaKfG6bU-69fk"; 
    
    // API endpoint ve model adÄ±
    const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${API_KEY}`;
    
    const userInput = document.getElementById('userInput');
    const sendButton = document.getElementById('sendButton');
    const outputDiv = document.getElementById('output');
    const loader = document.getElementById('loader');

    // Markdown'dan HTML'e Ã§eviri iÅŸlevi (Kod bloklarÄ±nÄ± <pre> olarak biÃ§imlendirmek iÃ§in)
    function formatResponse(text) {
        // KullanÄ±cÄ±nÄ±n sorusu
        const userPrompt = userInput.value.trim();
        let formattedHtml = `<p><strong>Siz:</strong> ${userPrompt}</p><hr>`;
        
        // Kod bloklarÄ±nÄ± bul (``` dil_adÄ± ... ```)
        const codeBlockRegex = /```(\w+)?\n([\s\S]*?)```/g;
        
        // Kod bloklarÄ±nÄ± <pre> etiketiyle deÄŸiÅŸtir
        let processedText = text.replace(codeBlockRegex, (match, language, code) => {
            // Kod iÃ§eriÄŸindeki Ã¶zel HTML karakterlerini dÃ¶nÃ¼ÅŸtÃ¼r
            const safeCode = code.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
            // Dil adÄ±nÄ± belirt
            const langDisplay = language ? `\n\n// Dil: ${language.toUpperCase()}\n\n` : '';
            return `<pre><code>${langDisplay}${safeCode.trim()}</code></pre>`;
        });
        
        // Normal metin kÄ±sÄ±mlarÄ±nÄ± <p> etiketi ile sarmala (Kaba bir ayÄ±rma)
        processedText = processedText.split('\n\n').map(p => {
            if (p.trim() && !p.startsWith('<pre>')) {
                return `<p>${p.trim()}</p>`;
            }
            return p;
        }).join('');

        formattedHtml += processedText;
        return formattedHtml;
    }

    // GÃ¶nderme Ä°ÅŸlevi
    async function sendMessage() {
        const prompt = userInput.value.trim();
        if (!prompt) return;

        // YÃ¼kleme durumu ayarlarÄ±
        sendButton.disabled = true;
        loader.style.display = 'block';
        outputDiv.innerHTML = `<p><strong>Siz:</strong> ${prompt}</p><hr><p>AI: Cevap bekleniyor...</p>`;
        
        // Bu kÄ±sÄ±m, AI'yÄ± kod odaklÄ± yanÄ±t vermeye yÃ¶nlendiren sistem talimatÄ±dÄ±r
        const systemInstructionText = "Sen BilalAI adlÄ± bir yapay zekasÄ±n. KullanÄ±cÄ± kod istediÄŸinde, cevabÄ±n sadece kodu ve kÄ±sa bir aÃ§Ä±klamayÄ± iÃ§ermelidir. Uzun giriÅŸ ve Ã§Ä±kÄ±ÅŸ metinlerinden kaÃ§Ä±n. MÃ¼mkÃ¼nse cevabÄ±nÄ± her zaman kod bloklarÄ± iÃ§inde (```) ver.";

        try {
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    config: {
                        // Sistemin davranÄ±ÅŸÄ±nÄ± tanÄ±mlayan talimat
                        systemInstruction: systemInstructionText,
                        // DÃ¼ÅŸÃ¼k sÄ±caklÄ±k, kod gibi kesin cevaplar iÃ§in daha iyidir.
                        temperature: 0.5 
                    },
                    contents: [{ role: "user", parts: [{ text: prompt }] }]
                })
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(`API Ä°stek HatasÄ± (${response.status}): ${errorData.error.message}`);
            }

            const data = await response.json();
            
            // CevabÄ± al
            const aiResponseText = data.candidates?.[0]?.content?.parts?.[0]?.text;
            
            if (aiResponseText) {
                // CevabÄ± biÃ§imlendirerek ekrana yaz
                outputDiv.innerHTML = formatResponse(aiResponseText);
            } else {
                outputDiv.innerHTML = `<p style="color: orange;"><strong>UYARI:</strong> BilalAI geÃ§erli bir yanÄ±t Ã¼retemedi. (GÃ¼venlik filtreleri tetiklenmiÅŸ olabilir.)</p>`;
            }

        } catch (error) {
            console.error('Ä°stek HatasÄ±:', error);
            outputDiv.innerHTML = `<p style="color: red;"><strong>KRÄ°TÄ°K HATA:</strong> BaÄŸlantÄ± veya API sorunu: ${error.message}</p>`;
        } finally {
            // YÃ¼kleme durumunu sÄ±fÄ±rla
            sendButton.disabled = false;
            loader.style.display = 'none';
        }
    }

    // Olay Dinleyicileri
    sendButton.addEventListener('click', sendMessage);
    userInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            sendMessage();
        }
    });

</script>

</body>
</html>
