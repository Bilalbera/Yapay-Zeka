<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>BilalAİ</title>
<style>
body { background:#0e0e0e; color:#fff; font-family:Arial }
.code { background:#2b2b2b; padding:10px; border-radius:6px }
button { margin-top:5px }
</style>
</head>
<body>

<h2>BilalAİ</h2>
<p>Yapım Aşamasındadır<br>
Hata bildirimi: bilaliletisim465@gmail.com</p>

<input id="msg" placeholder="Mesaj yaz">
<button onclick="send()">Gönder</button>

<div id="chat"></div>

<script>
let messages = [];

async function send() {
  const text = msg.value;
  msg.value = "";

  messages.push({role:"user", content:text});

  const res = await fetch("http://localhost:8000/chat", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ messages })
  });

  const data = await res.json();
  messages.push({role:"assistant", content:data.reply});

  render();
}

function render() {
  chat.innerHTML = "";
  messages.forEach(m => {
    if (m.content.includes("```")) {
      const code = m.content.split("```")[1];
      chat.innerHTML += `
        <div class="code">
          <pre>${code}</pre>
          <button onclick="navigator.clipboard.writeText(\`${code}\`)">Kopyala</button>
        </div>`;
    } else {
      chat.innerHTML += `<p><b>${m.role}:</b> ${m.content}</p>`;
    }
  });
}
</script>

</body>
</html>
